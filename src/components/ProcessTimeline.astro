---
const steps = [
  {
    step: "01",
    title: "Auditoría",
    desc: "Analizamos tu situación y definimos la arquitectura técnica.",
    icon: "M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2",
  },
  {
    step: "02",
    title: "Desarrollo Puro",
    desc: "Construimos tu búnker digital con Astro. Sin plantillas.",
    icon: "M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4",
  },
  {
    step: "03",
    title: "Blindaje",
    desc: "Seguridad por diseño y optimización de carga al milisegundo.",
    icon: "M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z",
  },
  {
    step: "04",
    title: "Entrega Total",
    desc: "Te damos las llaves. Propiedad 100% tuya. Despegue.",
    icon: "M13 10V3L4 14h7v7l9-11h-7z",
  },
];
---

<section class="py-24 relative z-10 reveal-on-scroll">
  <div class="max-w-6xl mx-auto px-4">
    <h2
      class="text-4xl md:text-5xl font-bold text-center text-white mb-20 fade-in-h2"
    >
      Tu camino al éxito
    </h2>

    <div
      class="relative flex flex-col md:flex-row justify-between items-start gap-8 md:gap-4"
    >
      <div
        class="hidden md:block absolute top-12 left-0 w-full h-0.5 bg-white/5 -z-10"
      >
      </div>
      <div
        class="md:hidden absolute top-0 left-8 h-full w-0.5 bg-white/5 -z-10"
      >
      </div>

      {
        steps.map((item) => (
          <div class="timeline-item group relative flex md:flex-col items-center md:text-center gap-6 md:gap-0 w-full md:w-1/4 p-4 rounded-xl transition-all duration-300 hover:bg-white/[0.02]">
            <div class="icon-wrapper relative flex-shrink-0 w-16 h-16 md:w-24 md:h-24 rounded-full bg-[#050505] border border-white/10 flex items-center justify-center group-hover:border-primary/50 group-hover:shadow-[0_0_30px_rgba(255,99,99,0.2)] transition-all duration-500 z-10 md:mb-6">
              <span class="absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-br from-primary to-orange-500 rounded-full flex items-center justify-center text-[10px] font-bold text-black">
                {item.step}
              </span>
              <svg
                class="w-6 h-6 md:w-8 md:h-8 text-gray-400 group-hover:text-white transition-colors"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d={item.icon}
                />
              </svg>
            </div>

            <div class="flex flex-col md:items-center">
              <h3 class="title text-xl font-bold text-white mb-2 group-hover:text-primary transition-colors">
                {item.title}
              </h3>
              <p class="text-sm text-gray-400 leading-relaxed">{item.desc}</p>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  /* Programmatic Hover Effects for Mobile Scroll */
  @media (max-width: 768px) {
    .timeline-item.hover-active {
      background-color: rgba(255, 255, 255, 0.02);
    }

    .timeline-item.hover-active .icon-wrapper {
      border-color: rgba(255, 99, 99, 0.5); /* primary/50 */
      box-shadow: 0 0 30px rgba(255, 99, 99, 0.2);
    }

    .timeline-item.hover-active svg {
      color: white;
    }

    .timeline-item.hover-active .title {
      color: #ff6363; /* primary */
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    if (window.matchMedia("(max-width: 768px)").matches) {
      const timelineItems = document.querySelectorAll(".timeline-item");

      const observerOptions = {
        root: null,
        rootMargin: "-20% 0px -20% 0px", // Trigger in the middle of screen
        threshold: 0.6,
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("hover-active");
          } else {
            entry.target.classList.remove("hover-active");
          }
        });
      }, observerOptions);

      timelineItems.forEach((item) => observer.observe(item));
    }
  });
</script>
